<%- include('../partials/header') %>

<h2>Tabla de posiciones</h2>

<% if (visibleTournaments.length > 1) { %>
  <div class="tournament-filter">
    <form method="get" action="/table">
      <label>Filtrar por torneo:
        <select name="tournament">
          <% visibleTournaments.forEach(t => { %>
            <option value="<%= t.id %>" <%= t.id == selectedTournament ? 'selected' : '' %>><%= t.name %></option>
          <% }) %>
        </select>
        <button type="submit">Filtrar</button>
      </label>
    </form>
  </div>
<% } %>

<div class="table-container">
   <table>
     <thead>
       <tr>
         <th>Equipo</th>
         <th>Usuario</th>
         <th>PJ</th>
         <th>G</th>
         <th>E</th>
         <th>P</th>
         <th>GF</th>
         <th>GC</th>
         <th>DG</th>
         <th>Pts</th>
       </tr>
     </thead>
     <tbody>
       <% if (!selectedTournament) { %>
         <tr>
           <td colspan="10">Selecciona un torneo para ver la tabla de posiciones.</td>
         </tr>
       <% } else if (table.length === 0) { %>
         <tr>
           <td colspan="10">No hay equipos registrados en este torneo.</td>
         </tr>
       <% } else { %>
         <% table.forEach(row => { %>
           <tr>
             <td><a href="/team/<%= row.id %>"><%= row.name %></a></td>
             <td><%= row.user_name || 'N/A' %></td>
             <td><%= row.played %></td>
             <td><%= row.wins %></td>
             <td><%= row.draws %></td>
             <td><%= row.losses %></td>
             <td><%= row.gf %></td>
             <td><%= row.ga %></td>
             <td><%= row.gd %></td>
             <td><%= row.points %></td>
           </tr>
         <% }) %>
       <% } %>
     </tbody>
   </table>
 </div>

<%- include('../partials/footer') %>
